# 6.6 函数匹配

> 本章术语：
>  
> * 候选函数（candidate function）：与被调用的函数同名；其声明在调用点可见。
> * 可行函数（viable function）：形参数量与本次调用提供的实参数量相等；每个实参的类型与对应的形参类型相同或能够转换成形参类型。

函数匹配的步骤：

1. 选定本次调用对应的重载函数集，集合中的函数称为候选函数。
2. 考察本次调用提供的实参，然后从候选函数中选出能被这组实参调用的函数。新选出的函数成为可行函数。*（如果没找到可行函数，编译器将报告无匹配函数的错误）*
3. 从可行函数中选择与本次调用最匹配的函数。（实参类型与形参类型越接近，他们匹配的越好）

最佳匹配原则：

* 该函数每个实参的匹配都不劣于其他可行函数需要的匹配。
* 至少有一个实参的匹配优于其他可行函数提供的匹配。

如果调用不满足最佳匹配原则，编译器将报告二义性调用的错误信息。

*调用重载函数时应尽量避免强制类型转换。如果在实际应用中确实需要强制类型转换，则说明我们设计的形参集合不合理。*

## 6.6.1 实参类型转换

为了确定最佳匹配，编译器将实参类型到形参类型的转换划分成几个等级：

1. 精确匹配
   * 实参类型和形参类型相同
   * 实参从数组类型或函数类型转换成对应的指针类型
   * 向实参添加顶层 const 或者从实参中删除顶层 const
2. 通过 const 转换实现的匹配（[4.11.2](../../Chapter4_表达式/note/note_4.11.md)）
3. 通过类型提升实现的匹配（[4.11.1](../../Chapter4_表达式/note/note_4.11.md)）
4. 通过算术类型转换（[4.11.1](../../Chapter4_表达式/note/note_4.11.md)）或指针转换（[4.11.2](../../Chapter4_表达式/note/note_4.11.md)）实现的匹配
5. 通过类类型转换实现的匹配（[14.9](TODO: Link)）

如果重载函数的区别在于他们的引用类型的形参是否引用了 const ，或者指针类型的形参是否指向 const ，则当调用发生时，编译器通过实参是否是常量来决定选择哪个函数。

## 练习

* [练习 6.49](../src/quiz_6.49.md)
* [练习 6.50](../src/quiz_6.50.md)
* [练习 6.51](../src/quiz_6.51.cpp)
* [练习 6.52](../src/quiz_6.52.md)
* [练习 6.53](../src/quiz_6.53.md)
